# 插件菜单排序功能说明

## 功能概述

菜单管理页面现在支持修改插件菜单的排序。插件菜单的排序值会保存在浏览器的 localStorage 中,因此即使刷新页面,自定义的排序也会保留。

## 使用方法

### 1. 查看插件菜单

登录系统后,进入 **系统管理 > 菜单管理** 页面。你会看到:

- **系统菜单**: 可以正常编辑和删除
- **插件菜单**: 带有"插件"标签,显示插件提供的菜单项

### 2. 调整插件菜单排序

对于插件菜单,点击 **"调整排序"** 按钮:

1. 弹出对话框,显示当前插件菜单的信息
2. 只能修改 **"排序"** 字段(其他字段被禁用)
3. 修改排序值(数值越小,菜单越靠前)
4. 点击 **"确定"** 保存

### 3. 示例

Kubernetes 插件的默认排序:
- Kubernetes管理: sort = 100
- 集群管理: sort = 1
- 节点管理: sort = 2
- 工作负载: sort = 3
- ...

如果你想将 "节点管理" 排在 "集群管理" 前面:
1. 找到 "节点管理" 菜单项
2. 点击 "调整排序" 按钮
3. 将排序值改为 `0` (小于集群管理的 1)
4. 点击确定

## 技术实现

### 数据存储

- **存储位置**: localStorage
- **存储键**: `opshub_plugin_menu_sort`
- **数据格式**: JSON 对象,键为菜单路径,值为排序值

示例:
```json
{
  "/kubernetes": 100,
  "/kubernetes/clusters": 1,
  "/kubernetes/nodes": 0,
  "/kubernetes/workloads": 3
}
```

### 优先级

插件菜单排序的优先级:
1. **自定义排序**(localStorage 中的值)
2. **默认排序**(插件配置文件中的值)

### 代码位置

- 前端文件: `web/src/views/system/Menus.vue`
- 关键函数:
  - `loadPluginMenuSort()`: 从 localStorage 加载自定义排序
  - `savePluginMenuSort()`: 保存排序到 localStorage
  - `handleEditPluginSort()`: 处理插件菜单编辑
  - `buildPluginMenuList()`: 构建插件菜单列表时应用自定义排序

## 注意事项

1. **浏览器本地存储**: 排序数据存储在浏览器本地,清除浏览器数据会导致自定义排序丢失
2. **仅修改排序**: 插件菜单只能修改排序字段,其他字段(名称、路径、图标等)由插件定义,不可修改
3. **即时生效**: 修改排序后立即生效,无需重启服务
4. **排序规则**: 数值越小越靠前,支持负数和小数

## 未来扩展

可以考虑的增强功能:
- 在插件管理页面添加批量排序调整
- 支持拖拽方式调整菜单顺序
- 提供排序重置功能(恢复到插件默认排序)
- 将排序数据保存到后端数据库,实现跨设备同步
